{"version":3,"names":[],"mappings":"","sources":["support.js"],"sourcesContent":["    (function(){\n        $.get('https://openrov.zendesk.com/embeddable/config')\n            .done(function(result){\n                result.embeds.ticketSubmissionForm.props.customFields.forEach(\n                    function(field) {\n                        if (field.type == \"text\" && field.title ==\"Name\") {\n                            $('#nameInput').data('id', field.id);\n                        }\n                        if (field.type == \"tagger\") {\n                            var control = $('#typeInput');\n                            control.data('id', field.id);\n                            control.append(field.options.map(function(o) {\n                                return '<option value=\"' + o.value+ '\">' + o.title +'</option>'\n                            }));\n\n                        }\n                    })\n            })\n\n        var submitedFrom = '\\n\\n------------------\\nSubmitted from: ' + location;\n        $('input[type=submit]').on('click', function(ev) {\n            ev.preventDefault();\n\n            $('#nameInput').parent().toggleClass('has-error', false)\n            $('#emailInput').parent().toggleClass('has-error', false)\n            $('#subjectInput').parent().toggleClass('has-error', false)\n            $('#descriptionInput').parent().toggleClass('has-error', false)\n            $('#typeInput').parent().parent().toggleClass('has-error', false)\n            var error = false;\n            try {\n                var name = $('#nameInput').val();\n                if (name.trim().length == 0) { $('#nameInput').parent().toggleClass('has-error', true); error = true; }\n\n                var email = $('#emailInput').val();\n                if (email.trim().length == 0) { $('#emailInput').parent().toggleClass('has-error', true); error = true; }\n                \n                var subject = $('#subjectInput').val();\n                if (subject.trim().length == 0) { $('#subjectInput').parent().toggleClass('has-error', true); error = true; }\n\n                var description = $('#descriptionInput').val();\n                if (description.trim().length == 0) { $('#descriptionInput').parent().toggleClass('has-error', true); error = true; }\n\n                var type = '';\n                $($('#typeInput')[0]).children().toArray().forEach(function(child) {\n                    if (child.selected) {\n                        if (child.value) {\n                            type = child.value\n                        }\n                    }\n                })\n                if (type.trim().length == 0) { $('#typeInput').parent().parent().toggleClass('has-error', true); error = true; }\n\n                var nameId = $('#nameInput').data('id');\n                var typeId = $('#typeInput').data('id');\n                var request = {\n                            \"subject\": subject, \n                            \"tags\": [\"web_widget\"], \n                            \"via_id\": 48, \n                            \"comment\": { \n                                \"body\": description + submitedFrom, \n                            }, \n                            \"requester\": \n                            { \n                                \"name\": name, \n                                \"email\": email, \n                                \"locale_id\": 1 \n                            }, \n                            \"fields\": { \n                            } \n                        }\n                request.fields[nameId] = name;\n                request.fields[typeId] = type;\n\n                if (error) return;\n\n                $('#submitter').prop('disabled', true);\n                $.ajax({\n                    type: \"POST\",\n                    url: 'https://openrov.zendesk.com/api/v2/requests.json',\n                    data: JSON.stringify( {request: request}),\n                    dataType: 'json',\n                    contentType: \"application/json\",\n                    beforeSend: function(xhr) { \n                        xhr.setRequestHeader(\"Authorization\", \"Basic \" + btoa(email +'/token:BO4MEQQtX70i6kDJqFmUb5voRNo8OPs2qcyGISBz')); \n                        }\n                }\n                )\n                .done(function(res) {\n                    alert(\"Thank you for your support request. You will hear from us shortly.\");\n                    $('#modal-contactSupport').modal('hide');\n                })\n                .fail(function(err) {\n                    alert('Whoops, something went wrong. Please try again later.')\n                })\n                \n            }\n            catch(err) {\n                console.error(err);\n                return;\n            }\n            if (error) { return }\n\n\n        })\n           \n\n    })()\n"],"file":"../support.js"}